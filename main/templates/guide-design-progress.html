{% extends 'base.html' %}

{% block head %}
{# Refresh the page to refetch the current status #}
<meta http-equiv="refresh" content="5">
{% endblock head %}

{% block content %}
<p>
  <em>This page will refresh every 5 seconds until all tasks are completed. If progress stops, go back and try again.</em>
</p>

<h3>
  {{ batch_status.completed|length }} out of {{ batch_status.statuses|length }} tasks completed
</h3>

<p>
  <div class="progress w-25">
    <div
      class="progress-bar progress-bar-striped"
      role="progressbar"
      style="width:{{ batch_status.percent_success }}%"
      aria-valuenow="{{ batch_status.percent_success }}"
      aria-valuemin="0"
      aria-valuemax="100"></div>
    <div
      class="progress-bar progress-bar-striped bg-danger"
      role="progressbar"
      style="width:{{ batch_status.percent_error }}%"
      aria-valuenow="{{ batch_status.percent_error }}"
      aria-valuemin="0"
      aria-valuemax="100"></div>
  </div>
</p>

{% if batch_status.errored %}
<h5>
  Errored
</h5>
<ul>
  {% for target in batch_status.errored %}
  <li>{{ target }}</li>
  {% endfor %}
</ul>
{% endif %}

{% if batch_status.running %}
<h5>
  Running
</h5>
<ul>
  {% for target in batch_status.running %}
  <li>{{ target }}</li>
  {% endfor %}
</ul>
{% endif %}

{% if batch_status.completed %}
<h5>
  Completed
</h5>
<ul>
  {% for target in batch_status.completed %}
  <li>{{ target }}</li>
  {% endfor %}
</ul>
{% endif %}

{% endblock %}
